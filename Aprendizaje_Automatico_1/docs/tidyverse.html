<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Tidyverse | Aprendizaje Automático 1</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Tidyverse | Aprendizaje Automático 1" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Tidyverse | Aprendizaje Automático 1" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Juan R González" />


<meta name="date" content="2020-09-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="regresión-lineal.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Aprendizaje Automático 1</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Inroducción</a></li>
<li class="chapter" data-level="2" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>2</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tidyverse.html"><a href="tidyverse.html#introducción"><i class="fa fa-check"></i><b>2.1</b> Introducción</a></li>
<li class="chapter" data-level="2.2" data-path="tidyverse.html"><a href="tidyverse.html#instalación"><i class="fa fa-check"></i><b>2.2</b> Instalación</a></li>
<li class="chapter" data-level="2.3" data-path="tidyverse.html"><a href="tidyverse.html#librerías-básicas"><i class="fa fa-check"></i><b>2.3</b> Librerías básicas</a></li>
<li class="chapter" data-level="2.4" data-path="tidyverse.html"><a href="tidyverse.html#manejo-de-datos"><i class="fa fa-check"></i><b>2.4</b> Manejo de datos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="tidyverse.html"><a href="tidyverse.html#tibbles"><i class="fa fa-check"></i><b>2.4.1</b> Tibbles</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="tidyverse.html"><a href="tidyverse.html#exercises-tibbles"><i class="fa fa-check"></i><b>2.5</b> Exercises (tibbles)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="tidyverse.html"><a href="tidyverse.html#importar-datos"><i class="fa fa-check"></i><b>2.5.1</b> Importar datos</a></li>
<li class="chapter" data-level="2.5.2" data-path="tidyverse.html"><a href="tidyverse.html#transformación-de-datos"><i class="fa fa-check"></i><b>2.5.2</b> Transformación de datos</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="tidyverse.html"><a href="tidyverse.html#dlpyr-basics"><i class="fa fa-check"></i><b>2.6</b> dlpyr basics</a></li>
<li class="chapter" data-level="2.7" data-path="tidyverse.html"><a href="tidyverse.html#filter-rows"><i class="fa fa-check"></i><b>2.7</b> Filter rows</a></li>
<li class="chapter" data-level="2.8" data-path="tidyverse.html"><a href="tidyverse.html#logical-filtering"><i class="fa fa-check"></i><b>2.8</b> Logical filtering</a></li>
<li class="chapter" data-level="2.9" data-path="tidyverse.html"><a href="tidyverse.html#arrange-rows"><i class="fa fa-check"></i><b>2.9</b> Arrange rows</a></li>
<li class="chapter" data-level="2.10" data-path="tidyverse.html"><a href="tidyverse.html#select-columns"><i class="fa fa-check"></i><b>2.10</b> Select columns</a></li>
<li class="chapter" data-level="2.11" data-path="tidyverse.html"><a href="tidyverse.html#add-new-variables"><i class="fa fa-check"></i><b>2.11</b> Add new variables</a></li>
<li class="chapter" data-level="2.12" data-path="tidyverse.html"><a href="tidyverse.html#grouped-summaries"><i class="fa fa-check"></i><b>2.12</b> Grouped summaries</a></li>
<li class="chapter" data-level="2.13" data-path="tidyverse.html"><a href="tidyverse.html#the-pipe"><i class="fa fa-check"></i><b>2.13</b> The pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="2.14" data-path="tidyverse.html"><a href="tidyverse.html#group-by-different-variables"><i class="fa fa-check"></i><b>2.14</b> Group by different variables</a></li>
<li class="chapter" data-level="2.15" data-path="tidyverse.html"><a href="tidyverse.html#useful-summary-functions"><i class="fa fa-check"></i><b>2.15</b> Useful summary functions</a></li>
<li class="chapter" data-level="2.16" data-path="tidyverse.html"><a href="tidyverse.html#exercises-data-transform"><i class="fa fa-check"></i><b>2.16</b> Exercises (data transform)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regresión-lineal.html"><a href="regresión-lineal.html"><i class="fa fa-check"></i><b>3</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="3.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#preliminares"><i class="fa fa-check"></i><b>3.1</b> Preliminares</a></li>
<li class="chapter" data-level="3.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#conceptos-básicos"><i class="fa fa-check"></i><b>3.2</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#modelo-lineal-simple"><i class="fa fa-check"></i><b>3.2.1</b> Modelo lineal simple</a></li>
<li class="chapter" data-level="3.2.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#regresión-lineal-multivariante"><i class="fa fa-check"></i><b>3.2.2</b> Regresión lineal multivariante</a></li>
<li class="chapter" data-level="3.2.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#incertidumbre"><i class="fa fa-check"></i><b>3.2.3</b> Incertidumbre</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#ajuste-de-un-modelo-lineal"><i class="fa fa-check"></i><b>3.3</b> Ajuste de un modelo lineal</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#residuos"><i class="fa fa-check"></i><b>3.3.1</b> Residuos</a></li>
<li class="chapter" data-level="3.3.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#coeficientes-de-interpretación"><i class="fa fa-check"></i><b>3.3.2</b> Coeficientes de interpretación</a></li>
<li class="chapter" data-level="3.3.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#interacciones"><i class="fa fa-check"></i><b>3.3.3</b> Interacciones</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="regresión-lineal.html"><a href="regresión-lineal.html#estimación-por-mínimos-cuadrados"><i class="fa fa-check"></i><b>3.4</b> Estimación por mínimos cuadrados</a></li>
<li class="chapter" data-level="3.5" data-path="regresión-lineal.html"><a href="regresión-lineal.html#medidas-adicionales-de-ajuste-del-modelo"><i class="fa fa-check"></i><b>3.5</b> Medidas adicionales de ajuste del modelo</a></li>
<li class="chapter" data-level="3.6" data-path="regresión-lineal.html"><a href="regresión-lineal.html#sesgo-variación-sobreajuste"><i class="fa fa-check"></i><b>3.6</b> Sesgo, variación, sobreajuste</a></li>
<li class="chapter" data-level="3.7" data-path="regresión-lineal.html"><a href="regresión-lineal.html#regresión-como-estimación-de-una-media-condicional"><i class="fa fa-check"></i><b>3.7</b> Regresión como estimación de una media condicional</a></li>
<li class="chapter" data-level="3.8" data-path="regresión-lineal.html"><a href="regresión-lineal.html#la-función-de-regresión"><i class="fa fa-check"></i><b>3.8</b> La función de regresión</a></li>
<li class="chapter" data-level="3.9" data-path="regresión-lineal.html"><a href="regresión-lineal.html#estimación-no-paramétrica-de-la-función-de-regresión-regresión-knn"><i class="fa fa-check"></i><b>3.9</b> Estimación no paramétrica de la función de regresión: regresión KNN</a></li>
<li class="chapter" data-level="3.10" data-path="regresión-lineal.html"><a href="regresión-lineal.html#estimación-paramétrica-de-la-función-de-regresión-regresión-lineal"><i class="fa fa-check"></i><b>3.10</b> Estimación paramétrica de la función de regresión: regresión lineal</a></li>
<li class="chapter" data-level="3.11" data-path="regresión-lineal.html"><a href="regresión-lineal.html#predicción-usando-el-objeto-del-modelo"><i class="fa fa-check"></i><b>3.11</b> Predicción usando el objeto del modelo</a></li>
<li class="chapter" data-level="3.12" data-path="regresión-lineal.html"><a href="regresión-lineal.html#inferencia-en-el-contexto-de-regresión"><i class="fa fa-check"></i><b>3.12</b> Inferencia en el contexto de regresión</a></li>
<li class="chapter" data-level="3.13" data-path="regresión-lineal.html"><a href="regresión-lineal.html#asunciones-de-un-modelo-de-regresión"><i class="fa fa-check"></i><b>3.13</b> Asunciones de un modelo de regresión</a></li>
<li class="chapter" data-level="3.14" data-path="regresión-lineal.html"><a href="regresión-lineal.html#ejemplos-adicionales-de-interpretación-de-modelos"><i class="fa fa-check"></i><b>3.14</b> Ejemplos adicionales de interpretación de modelos</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#interpretación-del-intercept-y-los-coeficientes-beta-para-un-modelo-con-predictores-continuos"><i class="fa fa-check"></i><b>3.14.1</b> Interpretación del <em>intercept</em> y los coeficientes <span class="math inline">\(\beta\)</span> para un modelo con predictores continuos</a></li>
<li class="chapter" data-level="3.14.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#interpretación-del-intercept-y-los-coeficientes-beta-para-un-modelo-con-predictores-binarios-y-continuos"><i class="fa fa-check"></i><b>3.14.2</b> Interpretación del <em>intercept</em> y los coeficientes <span class="math inline">\(\beta\)</span> para un modelo con predictores binarios y continuos</a></li>
<li class="chapter" data-level="3.14.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#interpretación-del-intercept-y-los-coeficientes-beta-para-un-modelo-con-predictores-binarios-y-continuos-con-interacciones"><i class="fa fa-check"></i><b>3.14.3</b> Interpretación del <em>intercept</em> y los coeficientes <span class="math inline">\(\beta\)</span> para un modelo con predictores binarios y continuos, con interacciones</a></li>
<li class="chapter" data-level="3.14.4" data-path="regresión-lineal.html"><a href="regresión-lineal.html#interpretación-del-intercept-y-los-coeficientes-beta-para-un-modelo-con-predictores-continuos-con-interacciones"><i class="fa fa-check"></i><b>3.14.4</b> Interpretación del <em>intercept</em> y los coeficientes <span class="math inline">\(\beta\)</span> para un modelo con predictores continuos, con interacciones</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="regresión-lineal.html"><a href="regresión-lineal.html#centrado-y-escalado"><i class="fa fa-check"></i><b>3.15</b> Centrado y escalado</a></li>
<li class="chapter" data-level="3.16" data-path="tidyverse.html"><a href="tidyverse.html#transformación-de-datos"><i class="fa fa-check"></i><b>3.16</b> Transformación de datos</a></li>
<li class="chapter" data-level="3.17" data-path="regresión-lineal.html"><a href="regresión-lineal.html#colinealidad"><i class="fa fa-check"></i><b>3.17</b> Colinealidad</a></li>
<li class="chapter" data-level="3.18" data-path="regresión-lineal.html"><a href="regresión-lineal.html#valores-atípicos"><i class="fa fa-check"></i><b>3.18</b> Valores atípicos</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Aprendizaje Automático 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Tidyverse</h1>
<div id="introducción" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Introducción</h2>
<center>
<div class="figure">
<img src="figures/tidiverse.png" width="450" alt="" />
<p class="caption">Tidyverse</p>
</div>
</center>
<p><a href="https://www.tidyverse.org/">tidyverse</a> es una forma elegante de usar R y hacer de este software una herramienta mejorada. Ha sido diseñado por <a href="http://hadley.nz/">Hadley / Rstudio</a> e incluye distintas librería que siguen las reglas principales del manifiesto de <a href="https://mran.microsoft.com/web/packages/tidyverse/vignettes/manifesto.html">The tidy tools</a>. Los autores describen esta nueva implementación como:</p>
<p><code>tidyverse es un conjunto de librerías que funcionan en armonía porque comparten representaciones de datos comunes y diseño de API. El paquete tidyverse está diseñado para facilitar la instalación y carga de los paquetes principales desde el tidyverse en un solo comando.</code></p>
<p>Existen numeros ayudas, cursos y material en general para aprender todo sobre las librerías de tidyverse, pero el autor ha usado el libro <a href="https://r4ds.had.co.nz/">R for Data Science</a> como base para ilustrar cómo usar este conjunto de herramientas para el análisis de datos en ciencias. Este libro (del que os he puesto el link) es una excelente fuente para aprender todo sobre <code>tidyverse</code>. En este capítulo os referenciaré otro material que puede ser de ayuda.</p>
<p>El libro de <a href="https://r4ds.had.co.nz/">R for Data Science</a> se organiza siguiendo este esquema:</p>
<div class="figure"><span id="fig:flujo"></span>
<img src="figures/flujoTrabajoAnalsisiDatos.gif" alt="Esquema R for Data Science" width="100%" />
<p class="caption">
Figure 2.1: Esquema R for Data Science
</p>
</div>
<p>De forma que las librerías incluidas en <code>tidyverse</code> cubren todos estos aspectos. Está pensado para facilitar tareas de gestión de datos, y en su caso, el manejo de grandes volúmenes de información de forma eficiente. Se describen técnicas que ayudan a la visualización de datos que es el primer paso que se debe llevar a cabo en cualquier análisis estadístico que se precie. Esta visualización y posterior análisis no sólo deber llevarse a cab o en toda la base de datos, puede requerirse analizar subconjuntos de datos obtenidos mediante algún filtro o inlcuso puede necesitarse recodificar o restructurar la información disponible . Quizás estos sean los procedimientos para los que <code>tidiverse</code> mejore de forma sustancial el uso de R tradicional (junto con la forma compacta y clara de escribir código), ya que la posterior modelización puede llevarse a cabo con decenas de librerías diseñadas para tal efecto.</p>
</div>
<div id="instalación" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Instalación</h2>
<p>Para instalar el conjunto básico de liberías relacionadas con <code>tidyverse</code> basta con ejecutar_</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="tidyverse.html#cb1-1"></a><span class="kw">install.package</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>Las librerías básicas relacionadas con <code>tidyverse</code> se cargan de la forma usual, con una única llamada</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="tidyverse.html#cb2-1"></a><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>La diferencia con el hecho de cargar cualquier otra librería, es que en un sólo comando se instalan/cargan un par de docenas de paquetes. Como beneficio adicional, uno puede estar seguro de que todos los paquetes instalados / cargados son de versiones compatibles.</p>
</div>
<div id="librerías-básicas" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Librerías básicas</h2>
<ul>
<li><p>Las librerías que son más conocidas y ampliamente utilizadas en <code>tidyverse</code> son:</p>
<ul>
<li><strong>ggplot2</strong>: visualización avanzada de datos</li>
<li><strong>dplyr</strong>: manipulación de datos de forma eficiente y escalable (usa Rcpp)</li>
<li><strong>tidyr</strong>: funciones para ordenar datos</li>
<li><strong>readr</strong>: importa datos.</li>
<li><strong>purrr</strong>: desarrolla una especie de “dialecto” de R que facilita muchas operaciones (map, Reduce, …)</li>
<li><strong>tibble</strong>: forma moderna para conceptualizar los datos.</li>
<li><strong>magrittr</strong>: canalización para hacer el código más legible (uso del “pipe” %&gt;%)</li>
</ul></li>
<li><p>Paquetes para manipular formatos de datos específicos:</p>
<ul>
<li><strong>hms</strong>: leer fácilmente fechas y tiempos</li>
<li><strong>stringr</strong>: funciones para trabajar de forma sencilla con cadenas de carácteres</li>
<li><strong>Lubridate</strong>: Manipulación avanzada de fechas</li>
<li><strong>Forcats</strong>: funciones avanzadas con factores</li>
</ul></li>
<li><p>Importar datos:</p>
<ul>
<li><strong>DBI</strong>: define una interfaz común entre R y los sistemas de administración de bases de datos (DBMS)</li>
<li><strong>haven</strong>: importar archivos SPSS, SAS y Stata de forma sencilla</li>
<li><strong>httr</strong>: facilitar el uso del paquete curl personalizado las necesidades de las API web modernas</li>
<li><strong>jsonlite</strong>: análisis y generación de JSON rápido y optimizado para obtener estadísticas en la web</li>
<li><strong>readxl</strong>: leer archivos read.xls y .xlsx de forma sencilla y sin necesitar otras dependencias</li>
<li><strong>rvest</strong>: obtener información de páginas web</li>
<li><strong>xml2</strong>: trabajar con XML</li>
</ul></li>
<li><p>Modelización: Existen varias librerías, pero yo prefiero usar las de R y/o Bioconductor</p></li>
</ul>
</div>
<div id="manejo-de-datos" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Manejo de datos</h2>
<p>En tidyverse, los data.frames se trabajan como <strong>tibbles</strong>. Esto permite disponer de una forma consistente y eficiente de guardar nuestros datos permitiendo una forma sencilla de hacer transformaciones, visualización y modelización. Esta sección pretende ser una introducción básica a <code>tidyverse</code> por lo que sólo veremos cómo llevar a cabo los principales tipos de manipulación de datos. No obstante, también existen funciones específicas para:</p>
<ul>
<li>Relacionar múltiples tablas <a href="https://rpubs.com/williamsurles/293454">ver ejemplos</a>.</li>
<li>Trabajar con variables carácter</li>
<li>Usar factores para variables categóricas de forma sencilla (sin los problemas de orden de categorías)</li>
<li>Realizar operaciones con variables de tipo fecha <a href="https://rpubs.com/carloslesmes/474297">ver ejemplos</a>.</li>
</ul>
<div id="tibbles" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Tibbles</h3>
<p>Empecemos introduciendo lo que es un <em>tibble</em> (pronunciado “tibel”). Se puede aprender más cosas ejecutando <code>vignette("tibble")</code> en la consola de RStudio. Tras cargar la librería <code>tidyverse</code> podemos crear un tibble a partir de un data.frame de la siguiente forma. Usaremos la base de datos iris a modo de ejemplo</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="tidyverse.html#cb3-1"></a><span class="kw">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="tidyverse.html#cb5-1"></a>iris.tib &lt;-<span class="st"> </span><span class="kw">tibble</span>(iris)</span>
<span id="cb5-2"><a href="tidyverse.html#cb5-2"></a>iris.tib</span></code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1          5.1         3.5          1.4         0.2 setosa 
##  2          4.9         3            1.4         0.2 setosa 
##  3          4.7         3.2          1.3         0.2 setosa 
##  4          4.6         3.1          1.5         0.2 setosa 
##  5          5           3.6          1.4         0.2 setosa 
##  6          5.4         3.9          1.7         0.4 setosa 
##  7          4.6         3.4          1.4         0.3 setosa 
##  8          5           3.4          1.5         0.2 setosa 
##  9          4.4         2.9          1.4         0.2 setosa 
## 10          4.9         3.1          1.5         0.1 setosa 
## # ... with 140 more rows</code></pre>
<p>También podemos crear un nuevo <em>tibble</em> mediante (los datos se reciclan):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="tidyverse.html#cb7-1"></a><span class="kw">tibble</span>(</span>
<span id="cb7-2"><a href="tidyverse.html#cb7-2"></a>  <span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, </span>
<span id="cb7-3"><a href="tidyverse.html#cb7-3"></a>  <span class="dt">y =</span> <span class="dv">1</span>, </span>
<span id="cb7-4"><a href="tidyverse.html#cb7-4"></a>  <span class="dt">z =</span> x <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y</span>
<span id="cb7-5"><a href="tidyverse.html#cb7-5"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##       x     y     z
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     1     2
## 2     2     1     5
## 3     3     1    10
## 4     4     1    17
## 5     5     1    26</code></pre>
<p>NOTA 1: Nunca cambia los tipos de datos! (i.e. caracter a factor)
NOTA 2: El <code>rownames</code> desaparece</p>
<p>Quizás uno de los aspectos más novedosos de las <em>tibble</em> sea que se ha re-definido el método <code>print()</code> que permite, por defecto, ver las 10 primeras filas y todas las columnas que quepan en la pantalla. Esto puede cambiarse con</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tidyverse.html#cb9-1"></a><span class="kw">print</span>(iris.tib, <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">width =</span> <span class="ot">Inf</span>)</span></code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1          5.1         3.5          1.4         0.2 setosa 
##  2          4.9         3            1.4         0.2 setosa 
##  3          4.7         3.2          1.3         0.2 setosa 
##  4          4.6         3.1          1.5         0.2 setosa 
##  5          5           3.6          1.4         0.2 setosa 
##  6          5.4         3.9          1.7         0.4 setosa 
##  7          4.6         3.4          1.4         0.3 setosa 
##  8          5           3.4          1.5         0.2 setosa 
##  9          4.4         2.9          1.4         0.2 setosa 
## 10          4.9         3.1          1.5         0.1 setosa 
## # ... with 140 more rows</code></pre>
<p>ó</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="tidyverse.html#cb11-1"></a><span class="kw">print</span>(iris.tib, <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">width =</span> <span class="dv">25</span>)</span></code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length
##           &lt;dbl&gt;
##  1          5.1
##  2          4.9
##  3          4.7
##  4          4.6
##  5          5  
##  6          5.4
##  7          4.6
##  8          5  
##  9          4.4
## 10          4.9
## # ... with 140 more
## #   rows, and 4 more
## #   variables:
## #   Sepal.Width &lt;dbl&gt;,
## #   Petal.Length &lt;dbl&gt;,
## #   Petal.Width &lt;dbl&gt;,
## #   Species &lt;fct&gt;</code></pre>
<p>Podemos acceder a una columna (e.g. variable) de la misma forma que con un data.frame</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="tidyverse.html#cb13-1"></a>df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb13-2"><a href="tidyverse.html#cb13-2"></a>  <span class="dt">x =</span> <span class="kw">runif</span>(<span class="dv">5</span>),</span>
<span id="cb13-3"><a href="tidyverse.html#cb13-3"></a>  <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb13-4"><a href="tidyverse.html#cb13-4"></a>)</span>
<span id="cb13-5"><a href="tidyverse.html#cb13-5"></a></span>
<span id="cb13-6"><a href="tidyverse.html#cb13-6"></a><span class="co"># Extract by name</span></span>
<span id="cb13-7"><a href="tidyverse.html#cb13-7"></a>df<span class="op">$</span>x</span></code></pre></div>
<pre><code>## [1] 0.1247389 0.2771619 0.1623948 0.8791650 0.2314237</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="tidyverse.html#cb15-1"></a>df[[<span class="st">&quot;x&quot;</span>]]</span></code></pre></div>
<pre><code>## [1] 0.1247389 0.2771619 0.1623948 0.8791650 0.2314237</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="tidyverse.html#cb17-1"></a><span class="co"># Extract by position</span></span>
<span id="cb17-2"><a href="tidyverse.html#cb17-2"></a>df[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 0.1247389 0.2771619 0.1623948 0.8791650 0.2314237</code></pre>
</div>
</div>
<div id="exercises-tibbles" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Exercises (tibbles)</h2>
<ol style="list-style-type: decimal">
<li><p>How can you know whether an object is a tibble? (Hint: try printing mtcars, which is a regular data frame).</p></li>
<li><p>If you have the name of a variable stored in an object, e.g. var &lt;- “mpg”, how can you extract the reference variable from a tibble?</p></li>
<li><p>What option controls how many additional column names are printed at the footer of a tibble?</p></li>
<li><p>Practice creating new variables in the following data frame</p></li>
</ol>
<pre><code>         tbl &lt;- tibble(
                  age = c(14, 18, 22, 12, 16, 19, 21, 24),
                  chol = c(172, 180, 185, 170, 175, 188, 190, 192),
                  sex = c(&quot;male&quot;, &quot;male&quot;, &quot;female&quot;, &quot;female&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;
                  )
                )</code></pre>
<p>by:
+ Extracting the variable called sex.
+ Plotting a scatterplot of age vs chol.
+ Creating a new column called chol2 which is chol to the power of 2.
+ Rename the columns to one, two and three.</p>
<div id="importar-datos" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Importar datos</h3>
<p>El paquete clave para leer datos es <em>readr</em></p>
<ul>
<li><p><em>read_csv ()</em> lee archivos delimitados por comas, <em>read_csv2 () </em> lee archivos separados por punto y coma (común en países donde, se usa como el lugar decimal), <em>read_tsv () </em> lee archivos delimitados por tabulaciones y <em>read_delim () </em> lee archivos con cualquier delimitador.</p></li>
<li><p><em>read_fwf ()</em> lee archivos de ancho fijo. Se puede especificar campos por sus anchos con <em>fwf_widths ()</em> o su posición con <em>fwf_positions ()</em>. <em>read_table ()</em> lee archivos de ancho fijo donde las columnas están separadas por espacios en blanco.</p></li>
<li><p><em>read_log ()</em> lee archivos de registro de estilo Apache (servidor web de código abierto). Pero también es muy útil <em>webreadr</em>, que está construido sobre <em>read_log ()</em> y proporciona muchas más herramientas útiles.</p></li>
</ul>
<p>Estas funciones suelen ser mucho más rápidas (~ 10x) que sus equivalentes en R básico. Además, la importación de datos de ejecución prolongada tienen una barra de progreso para que se pueda ver lo que está sucediendo. Si se está buscando velocidad bruta, también podemos usar <em>data.table::fread()</em> que aunque no encaja tan bien en <code>tidyverse</code> puede usarse en ocasiones donde precie la velocidad (pero no es mucho más rápido). Los datos se importan como objetos que:</p>
<ul>
<li>son *tibbles</li>
<li>no convierten vectores de caracteres en factores</li>
<li>no usan nombres de filas ni modifican los nombres de columnas. Éstas son fuentes comunes de frustración con las funciones base R [¡declaración de Hadley!].</li>
<li>Son más reproducibles. Las funciones de Base R heredan algún comportamiento de su sistema operativo y variables de entorno, por lo que el código para importar datos que funciona en un ordenador, podría no funcionar en el de otra persona.</li>
</ul>
<p>Hagamos una comparación con un archivo grande</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="tidyverse.html#cb20-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb20-2"><a href="tidyverse.html#cb20-2"></a><span class="kw">system.time</span>(dd1 &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/genome.txt&quot;</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    3.64    0.08    3.72</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="tidyverse.html#cb22-1"></a><span class="kw">system.time</span>(dd2 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data/genome.txt&quot;</span>, <span class="dt">delim=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.41    0.03    0.43</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="tidyverse.html#cb24-1"></a><span class="kw">dim</span>(dd2)</span></code></pre></div>
<pre><code>## [1] 733202      5</code></pre>
<p>Efectivamente ambos objetos contienen la misma información</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="tidyverse.html#cb26-1"></a><span class="kw">head</span>(dd1)</span></code></pre></div>
<pre><code>##         Name Chr  Position  Log.R.Ratio B.Allele.Freq
## 1  rs1000000  12 125456933 -0.002501764   1.000000000
## 2  rs1000002   3 185118461 -0.029741180   0.000336171
## 3 rs10000023   4  95952928  0.004015533   0.460671800
## 4  rs1000003   3  99825597 -0.142527700   0.541123600
## 5 rs10000030   4 103593179  0.365104000   1.000000000
## 6 rs10000037   4  38600725 -0.005177616   0.504625300</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="tidyverse.html#cb28-1"></a>dd2</span></code></pre></div>
<pre><code>## # A tibble: 733,202 x 5
##    Name       Chr    Position Log.R.Ratio B.Allele.Freq
##    &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;
##  1 rs1000000  12    125456933    -0.00250      1       
##  2 rs1000002  3     185118461    -0.0297       0.000336
##  3 rs10000023 4      95952928     0.00402      0.461   
##  4 rs1000003  3      99825597    -0.143        0.541   
##  5 rs10000030 4     103593179     0.365        1       
##  6 rs10000037 4      38600725    -0.00518      0.505   
##  7 rs10000041 4     165841405    -0.179        0       
##  8 rs10000042 4       5288053     0.168        0.998   
##  9 rs10000049 4     119167668    -0.00238      0       
## 10 rs1000007  2     237416793    -0.00411      0       
## # ... with 733,192 more rows</code></pre>
</div>
<div id="transformación-de-datos" class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Transformación de datos</h3>
<ul>
<li>It is rare that you get the data in exactly the right form you need.</li>
<li>Often you’ll need to create some new variables or summaries.</li>
<li>Or maybe you just want to rename the variables or reorder the observations in order to make the data a little easier to work with.</li>
</ul>
<hr />
<p>Let us illustrate how to manage available data using NYC fligths database. <code>nycflights13::flights</code> data frame contains all 336,776 flights that departed from New York City in 2013. The data comes from the US Bureau of Transportation Statistics, and is documented in <code>?flights</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="tidyverse.html#cb30-1"></a><span class="kw">library</span>(nycflights13)</span>
<span id="cb30-2"><a href="tidyverse.html#cb30-2"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<hr />
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="tidyverse.html#cb31-1"></a>flights</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight tailnum origin dest  air_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
##  1  2013     1     1      517            515         2      830            819        11 UA        1545 N14228  EWR    IAH        227
##  2  2013     1     1      533            529         4      850            830        20 UA        1714 N24211  LGA    IAH        227
##  3  2013     1     1      542            540         2      923            850        33 AA        1141 N619AA  JFK    MIA        160
##  4  2013     1     1      544            545        -1     1004           1022       -18 B6         725 N804JB  JFK    BQN        183
##  5  2013     1     1      554            600        -6      812            837       -25 DL         461 N668DN  LGA    ATL        116
##  6  2013     1     1      554            558        -4      740            728        12 UA        1696 N39463  EWR    ORD        150
##  7  2013     1     1      555            600        -5      913            854        19 B6         507 N516JB  EWR    FLL        158
##  8  2013     1     1      557            600        -3      709            723       -14 EV        5708 N829AS  LGA    IAD         53
##  9  2013     1     1      557            600        -3      838            846        -8 B6          79 N593JB  JFK    MCO        140
## 10  2013     1     1      558            600        -2      753            745         8 AA         301 N3ALAA  LGA    ORD        138
## # ... with 336,766 more rows, and 4 more variables: distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<div id="dlpyr-basics" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> dlpyr basics</h2>
<ul>
<li>Pick observations by their values: <code>filter()</code>.</li>
<li>Reorder the rows: <code>arrange()</code>.</li>
<li>Pick variables by their names: <code>select()</code>.</li>
<li>Create new variables with functions of existing variables: <code>mutate()</code>.</li>
<li>Collapse many values down to a single summary: <code>summarise()</code>.</li>
</ul>
<hr />
<p>All verbs work similarly:</p>
<ul>
<li><p>The first argument is a data frame.</p></li>
<li><p>The subsequent arguments describe what to do with the data frame, using the variable names (without quotes).</p></li>
<li><p>The result is a new data frame.</p></li>
</ul>
</div>
<div id="filter-rows" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Filter rows</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="tidyverse.html#cb33-1"></a>jan1 &lt;-<span class="st"> </span><span class="kw">filter</span>(flights, month <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, day <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<p>R either prints out the results, or saves them to a variable. If you want to do both, you can wrap the assignment in parentheses:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="tidyverse.html#cb34-1"></a>(jan1 &lt;-<span class="st"> </span><span class="kw">filter</span>(flights, month <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, day <span class="op">==</span><span class="st"> </span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## # A tibble: 842 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight tailnum origin dest  air_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
##  1  2013     1     1      517            515         2      830            819        11 UA        1545 N14228  EWR    IAH        227
##  2  2013     1     1      533            529         4      850            830        20 UA        1714 N24211  LGA    IAH        227
##  3  2013     1     1      542            540         2      923            850        33 AA        1141 N619AA  JFK    MIA        160
##  4  2013     1     1      544            545        -1     1004           1022       -18 B6         725 N804JB  JFK    BQN        183
##  5  2013     1     1      554            600        -6      812            837       -25 DL         461 N668DN  LGA    ATL        116
##  6  2013     1     1      554            558        -4      740            728        12 UA        1696 N39463  EWR    ORD        150
##  7  2013     1     1      555            600        -5      913            854        19 B6         507 N516JB  EWR    FLL        158
##  8  2013     1     1      557            600        -3      709            723       -14 EV        5708 N829AS  LGA    IAD         53
##  9  2013     1     1      557            600        -3      838            846        -8 B6          79 N593JB  JFK    MCO        140
## 10  2013     1     1      558            600        -2      753            745         8 AA         301 N3ALAA  LGA    ORD        138
## # ... with 832 more rows, and 4 more variables: distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
<div id="logical-filtering" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Logical filtering</h2>
<div class="figure">
<img src="figures/transform-logical.png" alt="" />
<p class="caption">boolean operations</p>
</div>
<hr />
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="tidyverse.html#cb36-1"></a><span class="kw">filter</span>(flights, month <span class="op">==</span><span class="st"> </span><span class="dv">11</span> <span class="op">|</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">12</span>)</span></code></pre></div>
<pre><code>## # A tibble: 55,403 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight tailnum origin dest  air_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
##  1  2013    11     1        5           2359         6      352            345         7 B6         745 N568JB  JFK    PSE        205
##  2  2013    11     1       35           2250       105      123           2356        87 B6        1816 N353JB  JFK    SYR         36
##  3  2013    11     1      455            500        -5      641            651       -10 US        1895 N192UW  EWR    CLT         88
##  4  2013    11     1      539            545        -6      856            827        29 UA        1714 N38727  LGA    IAH        229
##  5  2013    11     1      542            545        -3      831            855       -24 AA        2243 N5CLAA  JFK    MIA        147
##  6  2013    11     1      549            600       -11      912            923       -11 UA         303 N595UA  JFK    SFO        359
##  7  2013    11     1      550            600       -10      705            659         6 US        2167 N748UW  LGA    DCA         57
##  8  2013    11     1      554            600        -6      659            701        -2 US        2134 N742PS  LGA    BOS         40
##  9  2013    11     1      554            600        -6      826            827        -1 DL         563 N912DE  LGA    ATL        126
## 10  2013    11     1      554            600        -6      749            751        -2 DL         731 N315NB  LGA    DTW         93
## # ... with 55,393 more rows, and 4 more variables: distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<hr />
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="tidyverse.html#cb38-1"></a><span class="kw">filter</span>(flights, <span class="op">!</span>(arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">120</span> <span class="op">|</span><span class="st"> </span>dep_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">120</span>))</span></code></pre></div>
<pre><code>## # A tibble: 316,050 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight tailnum origin dest  air_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
##  1  2013     1     1      517            515         2      830            819        11 UA        1545 N14228  EWR    IAH        227
##  2  2013     1     1      533            529         4      850            830        20 UA        1714 N24211  LGA    IAH        227
##  3  2013     1     1      542            540         2      923            850        33 AA        1141 N619AA  JFK    MIA        160
##  4  2013     1     1      544            545        -1     1004           1022       -18 B6         725 N804JB  JFK    BQN        183
##  5  2013     1     1      554            600        -6      812            837       -25 DL         461 N668DN  LGA    ATL        116
##  6  2013     1     1      554            558        -4      740            728        12 UA        1696 N39463  EWR    ORD        150
##  7  2013     1     1      555            600        -5      913            854        19 B6         507 N516JB  EWR    FLL        158
##  8  2013     1     1      557            600        -3      709            723       -14 EV        5708 N829AS  LGA    IAD         53
##  9  2013     1     1      557            600        -3      838            846        -8 B6          79 N593JB  JFK    MCO        140
## 10  2013     1     1      558            600        -2      753            745         8 AA         301 N3ALAA  LGA    ORD        138
## # ... with 316,040 more rows, and 4 more variables: distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
<div id="arrange-rows" class="section level2" number="2.9">
<h2><span class="header-section-number">2.9</span> Arrange rows</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="tidyverse.html#cb40-1"></a><span class="kw">arrange</span>(flights, year, month, day)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight tailnum origin dest  air_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
##  1  2013     1     1      517            515         2      830            819        11 UA        1545 N14228  EWR    IAH        227
##  2  2013     1     1      533            529         4      850            830        20 UA        1714 N24211  LGA    IAH        227
##  3  2013     1     1      542            540         2      923            850        33 AA        1141 N619AA  JFK    MIA        160
##  4  2013     1     1      544            545        -1     1004           1022       -18 B6         725 N804JB  JFK    BQN        183
##  5  2013     1     1      554            600        -6      812            837       -25 DL         461 N668DN  LGA    ATL        116
##  6  2013     1     1      554            558        -4      740            728        12 UA        1696 N39463  EWR    ORD        150
##  7  2013     1     1      555            600        -5      913            854        19 B6         507 N516JB  EWR    FLL        158
##  8  2013     1     1      557            600        -3      709            723       -14 EV        5708 N829AS  LGA    IAD         53
##  9  2013     1     1      557            600        -3      838            846        -8 B6          79 N593JB  JFK    MCO        140
## 10  2013     1     1      558            600        -2      753            745         8 AA         301 N3ALAA  LGA    ORD        138
## # ... with 336,766 more rows, and 4 more variables: distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<hr />
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="tidyverse.html#cb42-1"></a><span class="kw">arrange</span>(flights, <span class="kw">desc</span>(dep_delay))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight tailnum origin dest  air_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
##  1  2013     1     9      641            900      1301     1242           1530      1272 HA          51 N384HA  JFK    HNL        640
##  2  2013     6    15     1432           1935      1137     1607           2120      1127 MQ        3535 N504MQ  JFK    CMH         74
##  3  2013     1    10     1121           1635      1126     1239           1810      1109 MQ        3695 N517MQ  EWR    ORD        111
##  4  2013     9    20     1139           1845      1014     1457           2210      1007 AA         177 N338AA  JFK    SFO        354
##  5  2013     7    22      845           1600      1005     1044           1815       989 MQ        3075 N665MQ  JFK    CVG         96
##  6  2013     4    10     1100           1900       960     1342           2211       931 DL        2391 N959DL  JFK    TPA        139
##  7  2013     3    17     2321            810       911      135           1020       915 DL        2119 N927DA  LGA    MSP        167
##  8  2013     6    27      959           1900       899     1236           2226       850 DL        2007 N3762Y  JFK    PDX        313
##  9  2013     7    22     2257            759       898      121           1026       895 DL        2047 N6716C  LGA    ATL        109
## 10  2013    12     5      756           1700       896     1058           2020       878 AA         172 N5DMAA  EWR    MIA        149
## # ... with 336,766 more rows, and 4 more variables: distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>NOTE: missing values are located at the end</p>
</div>
<div id="select-columns" class="section level2" number="2.10">
<h2><span class="header-section-number">2.10</span> Select columns</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="tidyverse.html#cb44-1"></a><span class="kw">select</span>(flights, year, month, day)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 3
##     year month   day
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1  2013     1     1
##  2  2013     1     1
##  3  2013     1     1
##  4  2013     1     1
##  5  2013     1     1
##  6  2013     1     1
##  7  2013     1     1
##  8  2013     1     1
##  9  2013     1     1
## 10  2013     1     1
## # ... with 336,766 more rows</code></pre>
<hr />
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="tidyverse.html#cb46-1"></a><span class="kw">select</span>(flights, year<span class="op">:</span>day)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 3
##     year month   day
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1  2013     1     1
##  2  2013     1     1
##  3  2013     1     1
##  4  2013     1     1
##  5  2013     1     1
##  6  2013     1     1
##  7  2013     1     1
##  8  2013     1     1
##  9  2013     1     1
## 10  2013     1     1
## # ... with 336,766 more rows</code></pre>
<hr />
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="tidyverse.html#cb48-1"></a><span class="kw">select</span>(flights, <span class="op">-</span>(year<span class="op">:</span>day))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 16
##    dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
##       &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1      517            515         2      830            819        11 UA        1545 N14228  EWR    IAH        227     1400     5     15
##  2      533            529         4      850            830        20 UA        1714 N24211  LGA    IAH        227     1416     5     29
##  3      542            540         2      923            850        33 AA        1141 N619AA  JFK    MIA        160     1089     5     40
##  4      544            545        -1     1004           1022       -18 B6         725 N804JB  JFK    BQN        183     1576     5     45
##  5      554            600        -6      812            837       -25 DL         461 N668DN  LGA    ATL        116      762     6      0
##  6      554            558        -4      740            728        12 UA        1696 N39463  EWR    ORD        150      719     5     58
##  7      555            600        -5      913            854        19 B6         507 N516JB  EWR    FLL        158     1065     6      0
##  8      557            600        -3      709            723       -14 EV        5708 N829AS  LGA    IAD         53      229     6      0
##  9      557            600        -3      838            846        -8 B6          79 N593JB  JFK    MCO        140      944     6      0
## 10      558            600        -2      753            745         8 AA         301 N3ALAA  LGA    ORD        138      733     6      0
## # ... with 336,766 more rows, and 1 more variable: time_hour &lt;dttm&gt;</code></pre>
<hr />
<p>There are a number of helper functions you can use within select():</p>
<ul>
<li><p><code>starts_with("abc")</code>: matches names that begin with “abc”.</p></li>
<li><p><code>ends_with("xyz")</code>: matches names that end with “xyz”.</p></li>
<li><p><code>contains("ijk")</code>: matches names that contain “ijk”.</p></li>
<li><p><code>matches("(.)\\1")</code>: selects variables that match a regular expression. This one matches any variables that contain repeated characters. You’ll learn more about regular expressions in <code>strings</code>.</p></li>
<li><p><code>num_range("x", 1:3)</code>: matches x1, x2 and x3.</p></li>
</ul>
</div>
<div id="add-new-variables" class="section level2" number="2.11">
<h2><span class="header-section-number">2.11</span> Add new variables</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="tidyverse.html#cb50-1"></a>flights_sml &lt;-<span class="st"> </span><span class="kw">select</span>(flights, </span>
<span id="cb50-2"><a href="tidyverse.html#cb50-2"></a>  year<span class="op">:</span>day, </span>
<span id="cb50-3"><a href="tidyverse.html#cb50-3"></a>  <span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>), </span>
<span id="cb50-4"><a href="tidyverse.html#cb50-4"></a>  distance, </span>
<span id="cb50-5"><a href="tidyverse.html#cb50-5"></a>  air_time</span>
<span id="cb50-6"><a href="tidyverse.html#cb50-6"></a>)</span>
<span id="cb50-7"><a href="tidyverse.html#cb50-7"></a><span class="kw">mutate</span>(flights_sml,</span>
<span id="cb50-8"><a href="tidyverse.html#cb50-8"></a>  <span class="dt">gain =</span> dep_delay <span class="op">-</span><span class="st"> </span>arr_delay,</span>
<span id="cb50-9"><a href="tidyverse.html#cb50-9"></a>  <span class="dt">speed =</span> distance <span class="op">/</span><span class="st"> </span>air_time <span class="op">*</span><span class="st"> </span><span class="dv">60</span></span>
<span id="cb50-10"><a href="tidyverse.html#cb50-10"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 9
##     year month   day dep_delay arr_delay distance air_time  gain speed
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2013     1     1         2        11     1400      227    -9  370.
##  2  2013     1     1         4        20     1416      227   -16  374.
##  3  2013     1     1         2        33     1089      160   -31  408.
##  4  2013     1     1        -1       -18     1576      183    17  517.
##  5  2013     1     1        -6       -25      762      116    19  394.
##  6  2013     1     1        -4        12      719      150   -16  288.
##  7  2013     1     1        -5        19     1065      158   -24  404.
##  8  2013     1     1        -3       -14      229       53    11  259.
##  9  2013     1     1        -3        -8      944      140     5  405.
## 10  2013     1     1        -2         8      733      138   -10  319.
## # ... with 336,766 more rows</code></pre>
<hr />
<p>If you only want to keep the new variables, use <code>transmute()</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="tidyverse.html#cb52-1"></a><span class="kw">transmute</span>(flights,</span>
<span id="cb52-2"><a href="tidyverse.html#cb52-2"></a>  <span class="dt">gain =</span> dep_delay <span class="op">-</span><span class="st"> </span>arr_delay,</span>
<span id="cb52-3"><a href="tidyverse.html#cb52-3"></a>  <span class="dt">hours =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,</span>
<span id="cb52-4"><a href="tidyverse.html#cb52-4"></a>  <span class="dt">gain_per_hour =</span> gain <span class="op">/</span><span class="st"> </span>hours</span>
<span id="cb52-5"><a href="tidyverse.html#cb52-5"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 3
##     gain hours gain_per_hour
##    &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
##  1    -9 3.78          -2.38
##  2   -16 3.78          -4.23
##  3   -31 2.67         -11.6 
##  4    17 3.05           5.57
##  5    19 1.93           9.83
##  6   -16 2.5           -6.4 
##  7   -24 2.63          -9.11
##  8    11 0.883         12.5 
##  9     5 2.33           2.14
## 10   -10 2.3           -4.35
## # ... with 336,766 more rows</code></pre>
</div>
<div id="grouped-summaries" class="section level2" number="2.12">
<h2><span class="header-section-number">2.12</span> Grouped summaries</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="tidyverse.html#cb54-1"></a><span class="kw">summarise</span>(flights, <span class="dt">delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   delay
##   &lt;dbl&gt;
## 1  12.6</code></pre>
<hr />
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="tidyverse.html#cb56-1"></a>by_day &lt;-<span class="st"> </span><span class="kw">group_by</span>(flights, year, month, day)</span>
<span id="cb56-2"><a href="tidyverse.html#cb56-2"></a><span class="kw">summarise</span>(by_day, <span class="dt">delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 365 x 4
## # Groups:   year, month [12]
##     year month   day delay
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1  2013     1     1 11.5 
##  2  2013     1     2 13.9 
##  3  2013     1     3 11.0 
##  4  2013     1     4  8.95
##  5  2013     1     5  5.73
##  6  2013     1     6  7.15
##  7  2013     1     7  5.42
##  8  2013     1     8  2.55
##  9  2013     1     9  2.28
## 10  2013     1    10  2.84
## # ... with 355 more rows</code></pre>
</div>
<div id="the-pipe" class="section level2" number="2.13">
<h2><span class="header-section-number">2.13</span> The pipe <code>%&gt;%</code></h2>
<p>Imagine that we want to explore the relationship between the distance and average delay for each location. The steps are:</p>
<p>There are three steps to prepare this data:</p>
<ul>
<li><p>Group flights by destination.</p></li>
<li><p>Summarise to compute distance, average delay, and number of flights.</p></li>
<li><p>Filter to remove noisy points and Honolulu airport, which is almost twice as far away as the next closest airport.</p></li>
</ul>
<hr />
<p>Using what you know about <code>dplyr</code>, you might write code like this:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="tidyverse.html#cb58-1"></a>by_dest &lt;-<span class="st"> </span><span class="kw">group_by</span>(flights, dest)</span>
<span id="cb58-2"><a href="tidyverse.html#cb58-2"></a>delay &lt;-<span class="st"> </span><span class="kw">summarise</span>(by_dest,</span>
<span id="cb58-3"><a href="tidyverse.html#cb58-3"></a>  <span class="dt">count =</span> <span class="kw">n</span>(),</span>
<span id="cb58-4"><a href="tidyverse.html#cb58-4"></a>  <span class="dt">dist =</span> <span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb58-5"><a href="tidyverse.html#cb58-5"></a>  <span class="dt">delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb58-6"><a href="tidyverse.html#cb58-6"></a>)</span>
<span id="cb58-7"><a href="tidyverse.html#cb58-7"></a>delay &lt;-<span class="st"> </span><span class="kw">filter</span>(delay, count <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, dest <span class="op">!=</span><span class="st"> &quot;HNL&quot;</span>)</span>
<span id="cb58-8"><a href="tidyverse.html#cb58-8"></a>delay</span></code></pre></div>
<pre><code>## # A tibble: 96 x 4
##    dest  count  dist delay
##    &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 ABQ     254 1826   4.38
##  2 ACK     265  199   4.85
##  3 ALB     439  143  14.4 
##  4 ATL   17215  757. 11.3 
##  5 AUS    2439 1514.  6.02
##  6 AVL     275  584.  8.00
##  7 BDL     443  116   7.05
##  8 BGR     375  378   8.03
##  9 BHM     297  866. 16.9 
## 10 BNA    6333  758. 11.8 
## # ... with 86 more rows</code></pre>
<hr />
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="tidyverse.html#cb60-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> delay, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dist, <span class="dt">y =</span> delay)) <span class="op">+</span></span>
<span id="cb60-2"><a href="tidyverse.html#cb60-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> count), <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb60-3"><a href="tidyverse.html#cb60-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_pipe-1.png" width="672" /></p>
<hr />
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="tidyverse.html#cb61-1"></a>delays &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-2"><a href="tidyverse.html#cb61-2"></a><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-3"><a href="tidyverse.html#cb61-3"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb61-4"><a href="tidyverse.html#cb61-4"></a>    <span class="dt">count =</span> <span class="kw">n</span>(),</span>
<span id="cb61-5"><a href="tidyverse.html#cb61-5"></a>    <span class="dt">dist =</span> <span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb61-6"><a href="tidyverse.html#cb61-6"></a>    <span class="dt">delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb61-7"><a href="tidyverse.html#cb61-7"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-8"><a href="tidyverse.html#cb61-8"></a><span class="st">  </span><span class="kw">filter</span>(count <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, dest <span class="op">!=</span><span class="st"> &quot;HNL&quot;</span>)</span>
<span id="cb61-9"><a href="tidyverse.html#cb61-9"></a>delays</span></code></pre></div>
<pre><code>## # A tibble: 96 x 4
##    dest  count  dist delay
##    &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 ABQ     254 1826   4.38
##  2 ACK     265  199   4.85
##  3 ALB     439  143  14.4 
##  4 ATL   17215  757. 11.3 
##  5 AUS    2439 1514.  6.02
##  6 AVL     275  584.  8.00
##  7 BDL     443  116   7.05
##  8 BGR     375  378   8.03
##  9 BHM     297  866. 16.9 
## 10 BNA    6333  758. 11.8 
## # ... with 86 more rows</code></pre>
</div>
<div id="group-by-different-variables" class="section level2" number="2.14">
<h2><span class="header-section-number">2.14</span> Group by different variables</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="tidyverse.html#cb63-1"></a>flights <span class="op">%&gt;%</span></span>
<span id="cb63-2"><a href="tidyverse.html#cb63-2"></a><span class="st">  </span><span class="kw">group_by</span>(year, month, day) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb63-3"><a href="tidyverse.html#cb63-3"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb63-4"><a href="tidyverse.html#cb63-4"></a>    <span class="dt">avg_delay1 =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</span>
<span id="cb63-5"><a href="tidyverse.html#cb63-5"></a>    <span class="dt">avg_delay2 =</span> <span class="kw">mean</span>(arr_delay[arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>], <span class="dt">na.rm=</span><span class="ot">TRUE</span>) </span>
<span id="cb63-6"><a href="tidyverse.html#cb63-6"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 365 x 5
## # Groups:   year, month [12]
##     year month   day avg_delay1 avg_delay2
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1  2013     1     1     12.7         32.5
##  2  2013     1     2     12.7         32.0
##  3  2013     1     3      5.73        27.7
##  4  2013     1     4     -1.93        28.3
##  5  2013     1     5     -1.53        22.6
##  6  2013     1     6      4.24        24.4
##  7  2013     1     7     -4.95        27.8
##  8  2013     1     8     -3.23        20.8
##  9  2013     1     9     -0.264       25.6
## 10  2013     1    10     -5.90        27.3
## # ... with 355 more rows</code></pre>
</div>
<div id="useful-summary-functions" class="section level2" number="2.15">
<h2><span class="header-section-number">2.15</span> Useful summary functions</h2>
<ul>
<li><code>count()</code></li>
<li><code>mean()</code></li>
<li><code>median()</code></li>
<li><code>min()</code></li>
<li><code>max()</code></li>
<li><code>quantile(x, 0.25)</code></li>
<li><code>IQR()</code></li>
<li><code>mad()</code></li>
</ul>
</div>
<div id="exercises-data-transform" class="section level2" number="2.16">
<h2><span class="header-section-number">2.16</span> Exercises (data transform)</h2>
<ol style="list-style-type: decimal">
<li><p>Using <code>flights</code> dataset, find all flights that</p>
<ul>
<li>Had an arrival delay of two or more hours</li>
<li>Flew to Houston (IAH or HOU)
<ul>
<li>Arrived more than two hours late, but didn’t leave late</li>
</ul></li>
<li>Were delayed by at least an hour, but made up over 30 minutes in flight</li>
</ul></li>
<li><p>Another useful dplyr filtering helper is between(). What does it do? Can you use it to simplify the code needed to answer the previous challenges?</p></li>
<li><p>Sort flights to find the fastest flights.</p></li>
<li><p>Create a new data frame having variables with the <code>dep</code> string.</p></li>
<li><p>Create a new data frame having the hour and minute of depature (Hint: information is in the variable <code>dep_time</code> with format HHMM or HMM. Use <code>%/%</code> or <code>%%</code> when appropriate)</p></li>
<li><p>Create a summary of each airline (variable <code>carrier</code>) describing the total number of flights, the average, median, IQR and variance delays. Which is the best airline in terms of those summary statistics?</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regresión-lineal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-tidyverse.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
